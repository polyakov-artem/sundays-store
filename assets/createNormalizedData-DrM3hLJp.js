import{r as d,c as R,j as a,k as A,B as E,a6 as D,e as B,u as f,h as L,s as S,C as k,A as $,D as w,v as Q,z,I as M,aa as F}from"./index-DFWjq6dT.js";import{I as H}from"./InputField-CRWtLilC.js";const I="product-price",V=`${I}__actual-price`,K=`${I}__old-price`,q=`${I}__discount-block`,G=`${I}__discount-price`,J=s=>{const{className:n,originalPrice:t,currentPrice:e,priceDifference:c,currencyChar:r,isDiscounted:o,...h}=s,m=R(I,n);let i;const p=a.jsxs("p",{className:R(A,V),children:[e," ",r]});return o?i=a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:q,children:[a.jsxs("span",{className:K,children:[t," ",r]}),a.jsxs("span",{className:G,children:[c," ",r]})]}),p]}):i=p,a.jsx("div",{className:m,...h,children:i})},dt=d.memo(J),T="counter",x=`${T}__btn`,W=`${T}__input`,X=`${T}__spinner`,b="minus",Y="plus",g=(s,n,t)=>n!==void 0&&s<n?n:t!==void 0&&s>t?t:s,Z=(s,n,t)=>{const e=s+n;return g(e,void 0,t)},tt=(s,n,t)=>{const e=s-n;return g(e,t,void 0)},et=s=>{const{className:n,count:t,onCountChange:e,max:c,min:r,disabled:o,isLoading:h,step:m=1,...i}=s,p=R(T,n),_=d.useCallback(l=>{if(o)return;const C=l.currentTarget.value===b?tt(t,m,r):Z(t,m,c);C!==t&&e(C)},[o,e,r,c,t,m]),y=d.useCallback(l=>{if(o)return;const C=parseInt(l.target.value);if(isNaN(C)){const N=r!==void 0?r:t;N!==t&&e(N);return}const u=g(C,r,c);u!==t&&e(u)},[o,e,r,c,t]);return a.jsxs("div",{...i,className:p,children:[a.jsx(E,{view:"round",theme:"secondary",el:"button",size:"sm",type:"button",className:x,onClick:_,icon:"-",value:b,disabled:o||r===t}),a.jsx(H,{theme:"primary",view:"primary",scale:"sm",className:W,value:t,inputMode:"numeric",onChange:y,disabled:o}),a.jsx(E,{view:"round",theme:"secondary",el:"button",size:"sm",type:"button",className:x,onClick:_,icon:"+",value:Y,disabled:o||c===t}),h&&a.jsx(D,{type:"round",theme:"green",className:X})]})},st=d.memo(et),j="purchase-buttons",nt=`${j}__add-btn`,at="Failed to update cart. Please try to reload the page.",ct=(s,n,t)=>t==null?void 0:t.find(e=>e.productId===s&&e.variant.id===n),rt=s=>{const{className:n,disabled:t,variantId:e,productId:c,...r}=s,o=R(j,n),{t:h}=B(),m=f(L),i=f(S),p=k[i],_=f($),[y,{data:l}]=w(),[C]=Q(),u=_||t,N=d.useMemo(()=>{var P;return((P=ct(c,e,l==null?void 0:l.lineItems))==null?void 0:P.quantity)||0},[l,c,e]),v=d.useCallback(async P=>{if(u)return;if((await C({cartDraft:{currency:p,country:i},changedQuantityItems:[{productId:c,variantId:e,nextQuantity:P}]})).error){z.error(at);return}},[C,i,p,u,c,e]);d.useEffect(()=>{y()},[y,m]);const O=d.useCallback(()=>{u||v(1)},[u,v]);let U;return N?U=a.jsx(st,{count:N,onCountChange:v,max:99,min:0,disabled:u,isLoading:_}):U=a.jsx(E,{el:"button",view:"primary",theme:"primary",icon:_?a.jsx(D,{type:"round",theme:"white"}):a.jsx(F,{}),text:h(M.AddToCart),size:"sm",iconBefore:!0,className:nt,onClick:O,disabled:u}),a.jsx("div",{...r,className:o,children:U})},lt=d.memo(rt),Ct=(s,n)=>{const t={ids:[],entities:{}};return s.forEach(e=>{const c=e[n];t.ids.push(c),t.entities[c]=e}),t};export{lt as P,dt as a,Ct as c};
